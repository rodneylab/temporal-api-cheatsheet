---
import {Content as Introduction} from '$components/introduction.md';
import {Content as Polyfill} from '$components/polyfill.md';
import {Content as Resources} from '$components/resources.md';
import '$styles/fonts.css';
import '$styles/global.css';
import getResult from '$utilities/file';

const methods = (await Astro.glob('../content/*.md')).sort((a,b)=> a.frontmatter.title.localeCompare(b.frontmatter.title));

const results = await Promise.all(methods.map(({file}) => {
  const path = file.replace(/\.md/, '').split('/').at(-1);
  return getResult(path);
}));

---
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>JavaScript Temporal API Cheatsheet</title>
  </head>
  <body>
  <main class="container">
    <h1 class="heading">JavaScript Temporal API Cheatsheet</h1>
    <div class="content">
    <Introduction />
    </div>
    <h2>Polyfill</h2>
    <div class="content">
    <Polyfill /></div>

    <section role="feed">
      <h2>Methods</h2>
        {methods.map(({Content, frontmatter: {docs, title}},index) => (
          <article class="content example">
            <h3 id={title} >{title}</h3>
            <Content />
            {results[index] ? 
              <div class="result">
                {results[index].now ? 
                  <div>Now: {results[index].now}</div> : null
                }
                <div>Result: <strong>{results[index].result}</strong></div>
              </div>
              : null
            }
            <div class="docs">
              <strong>Docs</strong>: <a href={docs}>{docs}</a>
            </div>
        </article>))}
    </section>
    <h2>Resources</h2>
    <div class="content">
      <Resources />
    </div>
  </main>
  </body>
</html>

<style>
  .container {
    background-color: var(--colour-brand);
    color: var(--colour-light);
    width: min(100% - var(--spacing-12), var(--max-width-wrapper));
    margin: var(--spacing-0) auto;
    padding: var(--spacing-12) var(--spacing-0);
    font-size: var(--font-size-1);
    line-height: var(--line-height-normal);
  }

  .heading {
    text-align: center;
  }

  .content {
    background-color: var(--colour-theme);
    border-radius: var(--spacing-4);
    border: var(--spacing-1) solid var(--colour-light);
    padding: var(--spacing-2) var(--spacing-6) var(--spacing-4);
    margin-bottom: var(--spacing-12);
  }

  .content h2 {
    color: var(--colour-light);
  }

  .result {
    background-color: var(--colour-light);
    color: var(--colour-dark);
    padding: var(--spacing-4);
    border-radius: var(--spacing-1);
    border: var(--spacing-px-2) solid var(--colour-alt);
    font-family: IBM Plex Mono;
    margin-bottom: var(--spacing-4);
  }

  .docs, .docs a {
    color: var(--colour-brand);
    margin-bottom: var(--spacing-2);
  }
</style>